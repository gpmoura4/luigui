def generate_postgres_schemas(json_data):
    # Agrupa as colunas por (schema, tabela)    
    tables = {}
    for entry in json_data:
        schema = entry['schema_name']
        table = entry['table_name']
        column = entry['column_name']
        column_type = entry['column_type']
        
        key = (schema, table)
        if key not in tables:
            tables[key] = []
        tables[key].append(f'    "{column}" {column_type}')
    
    # Gera os comandos SQL para cada tabela e os armazena numa lista
    schemas = []
    for (schema, table), columns in tables.items():
        sql = f'CREATE SCHEMA IF NOT EXISTS "{schema}";\n'
        sql += f'CREATE TABLE IF NOT EXISTS "{schema}"."{table}" (\n'
        sql += ",\n".join(columns)
        sql += "\n);"
        schemas.append({"schema": sql, "table_name": table})
    
    return schemas


json = [{"schema_name" : "public", "table_name" : "data_vector", "column_name" : "embedding", "column_type" : "USER-DEFINED"}, {"schema_name" : "public", "table_name" : "sec_text_chunk", "column_name" : "page_label", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "auth_group_permissions", "column_name" : "group_id", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "auth_group_permissions", "column_name" : "permission_id", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "auth_user_groups", "column_name" : "id", "column_type" : "bigint"}, {"schema_name" : "public", "table_name" : "auth_user_groups", "column_name" : "user_id", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "auth_user_groups", "column_name" : "group_id", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "auth_user_user_permissions", "column_name" : "id", "column_type" : "bigint"}, {"schema_name" : "public", "table_name" : "auth_user_user_permissions", "column_name" : "user_id", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "auth_user_user_permissions", "column_name" : "permission_id", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "auth_user", "column_name" : "id", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "auth_user", "column_name" : "last_login", "column_type" : "timestamp with time zone"}, {"schema_name" : "public", "table_name" : "auth_user", "column_name" : "is_superuser", "column_type" : "boolean"}, {"schema_name" : "public", "table_name" : "auth_user", "column_name" : "is_staff", "column_type" : "boolean"}, {"schema_name" : "public", "table_name" : "auth_user", "column_name" : "is_active", "column_type" : "boolean"}, {"schema_name" : "public", "table_name" : "auth_user", "column_name" : "date_joined", "column_type" : "timestamp with time zone"}, {"schema_name" : "public", "table_name" : "django_admin_log", "column_name" : "id", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "django_admin_log", "column_name" : "action_time", "column_type" : "timestamp with time zone"}, {"schema_name" : "public", "table_name" : "django_admin_log", "column_name" : "action_flag", "column_type" : "smallint"}, {"schema_name" : "public", "table_name" : "django_admin_log", "column_name" : "content_type_id", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "django_admin_log", "column_name" : "user_id", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "django_session", "column_name" : "expire_date", "column_type" : "timestamp with time zone"}, {"schema_name" : "public", "table_name" : "api_database", "column_name" : "id", "column_type" : "bigint"}, {"schema_name" : "public", "table_name" : "api_database", "column_name" : "port", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "api_database", "column_name" : "have_obj_index", "column_type" : "boolean"}, {"schema_name" : "public", "table_name" : "api_database", "column_name" : "user_id", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "api_questionanswer", "column_name" : "id", "column_type" : "bigint"}, {"schema_name" : "public", "table_name" : "api_questionanswer", "column_name" : "database_id", "column_type" : "bigint"}, {"schema_name" : "public", "table_name" : "api_table", "column_name" : "id", "column_type" : "bigint"}, {"schema_name" : "public", "table_name" : "api_table", "column_name" : "database_id", "column_type" : "bigint"}, {"schema_name" : "public", "table_name" : "city_stats", "column_name" : "population", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "city_stats2", "column_name" : "population", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "data_vector", "column_name" : "id", "column_type" : "bigint"}, {"schema_name" : "public", "table_name" : "data_vector", "column_name" : "metadata_", "column_type" : "json"}, {"schema_name" : "public", "table_name" : "sec_text_chunk", "column_name" : "id", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "sec_text_chunk", "column_name" : "embedding", "column_type" : "USER-DEFINED"}, {"schema_name" : "public", "table_name" : "django_migrations", "column_name" : "id", "column_type" : "bigint"}, {"schema_name" : "public", "table_name" : "django_migrations", "column_name" : "applied", "column_type" : "timestamp with time zone"}, {"schema_name" : "public", "table_name" : "django_content_type", "column_name" : "id", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "auth_permission", "column_name" : "id", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "auth_permission", "column_name" : "content_type_id", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "auth_group", "column_name" : "id", "column_type" : "integer"}, {"schema_name" : "public", "table_name" : "auth_group_permissions", "column_name" : "id", "column_type" : "bigint"}, {"schema_name" : "public", "table_name" : "sec_text_chunk", "column_name" : "file_name", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "sec_text_chunk", "column_name" : "text", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "api_database", "column_name" : "host", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "city_stats", "column_name" : "city_name", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "django_migrations", "column_name" : "app", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "django_migrations", "column_name" : "name", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "data_vector", "column_name" : "node_id", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "city_stats", "column_name" : "country", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "django_content_type", "column_name" : "app_label", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "django_content_type", "column_name" : "model", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "api_questionanswer", "column_name" : "question", "column_type" : "text"}, {"schema_name" : "public", "table_name" : "auth_permission", "column_name" : "name", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "django_admin_log", "column_name" : "object_id", "column_type" : "text"}, {"schema_name" : "public", "table_name" : "auth_permission", "column_name" : "codename", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "django_admin_log", "column_name" : "object_repr", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "auth_group", "column_name" : "name", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "api_questionanswer", "column_name" : "answer", "column_type" : "text"}, {"schema_name" : "public", "table_name" : "django_admin_log", "column_name" : "change_message", "column_type" : "text"}, {"schema_name" : "public", "table_name" : "api_questionanswer", "column_name" : "query", "column_type" : "text"}, {"schema_name" : "public", "table_name" : "city_stats2", "column_name" : "city_name", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "django_session", "column_name" : "session_key", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "django_session", "column_name" : "session_data", "column_type" : "text"}, {"schema_name" : "public", "table_name" : "data_vector", "column_name" : "text", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "api_table", "column_name" : "name", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "api_database", "column_name" : "name", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "api_database", "column_name" : "username", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "auth_user", "column_name" : "password", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "api_database", "column_name" : "password", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "city_stats2", "column_name" : "country", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "auth_user", "column_name" : "username", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "auth_user", "column_name" : "first_name", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "auth_user", "column_name" : "last_name", "column_type" : "character varying"}, {"schema_name" : "public", "table_name" : "auth_user", "column_name" : "email", "column_type" : "character varying"}]


schemas = generate_postgres_schemas(json)
print(schemas)